# 예약 이체 시스템

사용자가 미래의 특정 날짜에 송금을 예약할 수 있는 기능을 제공하고자 합니다. 단, 예약 이체는 하루 최대 10건까지만 등록 가능하도록 제한합니다.

## 1. User Scenarios

### 시나리오 1: 예약 이체 등록 성공
- 사용자 A가 2025-06-23에 대해 3건의 예약 이체를 등록함
- 서버 시간 기준으로 해당 일자에 대한 예약 건수는 10건 이하 → 등록 성공

### 시나리오 2: 예약 이체 등록 실패 (건수 초과)
- 사용자 B가 이미 2025-06-23에 대해 10건의 예약 이체를 등록함
- 추가 등록 시, 에러 메시지와 함께 거부됨
- 처리 기준 시간은 서버 타임존 KST(UTC+09:00)로 처리

### 시나리오 3: 동시 요청 처리
- 사용자 C가 동일한 예약일에 대해 거의 동시에 2건의 예약 이체 요청
- 두 요청이 모두 건수 초과 조건에 걸리는지 판단 → 하나만 성공하거나 둘 다 거절됨 (동시성 고려 필요)


## 2. Requirements

### 예약 이체 등록

- 예약 이체는 scheduled_date, amount, receiver_account 등의 정보를 포함
- 실행일 기준으로 자동 이체 처리됨
- scheduled_date가 동일한 예약 이체가 10건 이상이면 등록 실패 (실패/취소된 예약은 개수에서 제외)


## 3. Success Metrics

| 항목 | 목표 지표 |
|---|---|
|정책 우회 차단율| 100% |
|등록 처리 속도 | 평균 100ms 이내|


## 4. Etc.

### 예외 응답 예시

```json
{
  "resultType": "FAIL",
  "error": {
    "code": 0000
    "type": "limit_exceeded",
    "message": "예약 이체는 하루 최대 10건까지만 등록할 수 있습니다.",
    "timestamp": "2025-06-23T10:02:11.369+09:00",
    "traceId": "sched-aaa111bbb222-xyz^1723423123000^884774"
  },
  "success": null
}
```

### 예외 응답 설명

| 필드명         | 설명 |
|----------------|------|
| `resultType`   | 항상 `"FAIL"` |
| `error.code`   | 에러 코드 |
| `error.type`   | 에러 유형 (예: `limit_exceeded`, `not_found`, `validation_failed`) |
| `error.message`| 사용자에게 보여줄 메시지 |
| `error.timestamp` | ISO-8601 시간 문자열 (서버 시간 기준) |
| `error.traceId`| 로그 추적용 ID. 로그 시스템과 연동 가능 |
| `success`      | 항상 `null` (`resultType: FAIL`일 때) |
